!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("rxjs/Subject"),require("rxjs/operator/debounceTime"),require("rxjs/operator/map"),require("@angular/common")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/forms","rxjs/Subject","rxjs/operator/debounceTime","rxjs/operator/map","@angular/common"],t):t(e.core={},e.ng.core,e.ng.forms,e.Rx,e.Rx.Observable.prototype,e.Rx.Observable.prototype,e.ng.common)}(this,function(e,t,o,r,i,n,s){"use strict";function a(e,t,o){if(t.id)return t.id;var r=t.type;return!r&&t.template&&(r="template"),[e,r,t.key,o].join("_")}function l(e){if(!e._formlyKeyPath||e._formlyKeyPath.key!==e.key){var t=[];if(e.key){for(var o=0,r="string"==typeof e.key?e.key.split("."):e.key;o<r.length;o++)"string"==typeof(n=r[o])?(n=n.replace(/\[(\w+)\]/g,".$1"),t=t.concat(n.split("."))):t.push(n);for(var i=0;i<t.length;i++){var n=t[i];"string"==typeof n&&p(n)&&(t[i]=parseInt(n))}}e._formlyKeyPath={key:e.key,path:t}}return e._formlyKeyPath.path.slice(0)}function p(e){return!h(e)&&/^\d+$/.test(e)}function f(e,t,o){for(var r=l(t),i=e,n=0;n<r.length;n++){var s=r[n];if(h(i[s])&&o&&(n<r.length-1?i[s]="number"==typeof r[n+1]?[]:{}:t.fieldGroup&&!t.fieldArray?i[s]={}:t.fieldArray&&(i[s]=[])),!(i=i[s]))break}return i}function d(e,t,o){if("string"==typeof t&&(t=l({key:t})),t.length>1){var r=t.shift();e[r]&&C(e[r])||(e[r]="string"==typeof t[0]?{}:[]),d(e[r],t,o)}else e[t[0]]=o}function u(e,t){if("string"==typeof t&&(t=l({key:t})),t.length>1){var o=t.shift();return e[o]||(e[o]="string"==typeof t[0]?{}:[]),u(e[o],t)}return e[t[0]]}function c(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return t.forEach(function(t){for(var o in t)h(e[o])||m(e[o])?g(t[o])?e[o]=t[o]:e[o]=F(t[o]):v(e[o],t[o])&&c(e[o],t[o])}),e}function h(e){return e===undefined||null===e}function y(e){return e===undefined}function m(e){return""===e}function g(e){return"function"==typeof e}function v(e,t){return C(e)&&C(t)&&Object.getPrototypeOf(e)===Object.getPrototypeOf(t)}function C(e){return null!=e&&"object"==typeof e}function F(e){return!C(e)||e instanceof RegExp?e:"[object Date]"===Object.prototype.toString.call(e)?new Date(e.getTime()):Array.isArray(e)?e.slice(0).map(function(e){return F(e)}):(e=Object.assign({},e),Object.keys(e).forEach(function(t){return e[t]=F(e[t])}),e)}function b(e,t){try{return Function.bind.apply(Function,[void 0].concat(t.concat("return "+e+";")))()}catch(o){console.error(o)}}function O(e,t){try{return Function.bind.apply(Function,[void 0].concat(t.concat(e+" = expressionValue;")))()}catch(o){console.error(o)}}function V(e,t,o){return e instanceof Function?e.apply(t,o):!!e}var k=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function r(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),E=["required","pattern","minLength","maxLength","min","max"],x=new t.InjectionToken("FORMLY_CONFIG_TOKEN"),w=function(){function e(e){void 0===e&&(e=[]);var t=this;this.types={},this.validators={},this.wrappers={},this.messages={},this.templateManipulators={preWrapper:[],postWrapper:[]},this.extras={fieldTransform:undefined,showError:function(e){return e.formControl&&e.formControl.invalid&&(e.formControl.touched||e.options.parentForm&&e.options.parentForm.submitted||e.field.validation&&e.field.validation.show)}},e.forEach(function(e){return t.addConfig(e)})}return e.prototype.addConfig=function(e){var t=this;e.types&&e.types.forEach(function(e){return t.setType(e)}),e.validators&&e.validators.forEach(function(e){return t.setValidator(e)}),e.wrappers&&e.wrappers.forEach(function(e){return t.setWrapper(e)}),e.manipulators&&e.manipulators.forEach(function(e){return t.setManipulator(e)}),e.validationMessages&&e.validationMessages.forEach(function(e){return t.addValidatorMessage(e.name,e.message)}),e.extras&&(this.extras=Object.assign({},this.extras,e.extras))},e.prototype.setType=function(e){var t=this;Array.isArray(e)?e.forEach(function(e){return t.setType(e)}):(this.types[e.name]||(this.types[e.name]={}),this.types[e.name].component=e.component,this.types[e.name].name=e.name,this.types[e.name]["extends"]=e["extends"],this.types[e.name].defaultOptions=e.defaultOptions,e.wrappers&&e.wrappers.forEach(function(o){return t.setTypeWrapper(e.name,o)}))},e.prototype.getType=function(e){if(!this.types[e])throw new Error('[Formly Error] There is no type by the name of "'+e+'"');return this.mergeExtendedType(e),this.types[e]},e.prototype.getMergedField=function(e){var t=this;void 0===e&&(e={});var o=e.type;if(!this.types[o])throw new Error('[Formly Error] There is no type by the name of "'+o+'"');this.mergeExtendedType(o),this.types[o].defaultOptions&&c(e,this.types[o].defaultOptions);var r=this.types[o]["extends"]&&this.getType(this.types[o]["extends"]).defaultOptions;r&&c(e,r),e&&e.optionsTypes&&e.optionsTypes.forEach(function(o){var r=t.getType(o).defaultOptions;r&&c(e,r)}),e.component||(e.component=this.types[o].component),e.wrappers||(e.wrappers=this.types[o].wrappers)},e.prototype.setWrapper=function(e){var t=this;this.wrappers[e.name]=e,e.types&&e.types.forEach(function(o){t.setTypeWrapper(o,e.name)})},e.prototype.getWrapper=function(e){if(!this.wrappers[e])throw new Error('[Formly Error] There is no wrapper by the name of "'+e+'"');return this.wrappers[e]},e.prototype.setTypeWrapper=function(e,t){this.types[e]||(this.types[e]={}),this.types[e].wrappers||(this.types[e].wrappers=[]),this.types[e].wrappers.push(t)},e.prototype.setValidator=function(e){this.validators[e.name]=e},e.prototype.getValidator=function(e){if(!this.validators[e])throw new Error('[Formly Error] There is no validator by the name of "'+e+'"');return this.validators[e]},e.prototype.addValidatorMessage=function(e,t){this.messages[e]=t},e.prototype.getValidatorMessage=function(e){return this.messages[e]},e.prototype.setManipulator=function(e){(new e["class"])[e.method](this)},e.prototype.mergeExtendedType=function(e){if(this.types[e]["extends"]){var t=this.getType(this.types[e]["extends"]);this.types[e].component||(this.types[e].component=t.component),this.types[e].wrappers||(this.types[e].wrappers=t.wrappers)}},e}();w.decorators=[{type:t.Injectable}],w.ctorParameters=function(){return[{type:Array,decorators:[{type:t.Inject,args:[x]}]}]};var A=function(){function e(){}return e.prototype.checkFields=function(e,t,o,r){void 0===t&&(t=[]),this._checkFields(e,t,o,r)},e.prototype._checkFields=function(e,t,o,r){var i=this;void 0===t&&(t=[]),t.forEach(function(t){i.checkFieldExpressionChange(e,t,i.getParentModel(o,t),r),i.checkFieldVisibilityChange(e,t,i.getParentModel(o,t),r),t.fieldGroup&&t.fieldGroup.length>0&&i._checkFields(t.formControl?t.formControl:e,t.fieldGroup,i.getParentModel(o,t),r)})},e.prototype.checkFieldExpressionChange=function(e,t,o,r){if(t&&t.expressionProperties){var i=t.expressionProperties,n=E.map(function(e){return"templateOptions."+e});for(var s in i){var a=V(i[s].expression,{field:t},[o,r.formState]);if(i[s].expressionValue!==a&&(!C(a)||JSON.stringify(a)!==JSON.stringify(i[s].expressionValue))){if(i[s].expressionValue=a,V(i[s].expressionValueSetter,{field:t},[a,o,t]),0===s.indexOf("model.")){var l=s.replace(/^model\./,""),p=t.key&&s===l?t.formControl:e.get(l);!p||h(p.value)&&h(a)||p.value===a||p.patchValue(a)}-1!==n.indexOf(s)&&t.formControl&&t.formControl.updateValueAndValidity({emitEvent:!1})}}}},e.prototype.checkFieldVisibilityChange=function(e,t,o,r){if(t&&!h(t.hideExpression)){var i=!!V(t.hideExpression,{field:t},[o,r.formState]);if(i!==t.hide){if(t.hide=i,t.templateOptions.hidden=i,t.formControl&&t.key){var n=this.fieldParentFormControl(e,t);n&&(!0===i&&n.get(this.fieldKey(t))?this.removeFieldControl(n,t):!1!==i||n.get(this.fieldKey(t))||this.addFieldControl(n,t,o))}r.fieldChanges&&r.fieldChanges.next({field:t,type:"hidden",value:i})}}},e.prototype.addFieldControl=function(e,t,r){var i=this.getFieldModel(r,t);h(t.formControl.value)&&h(i)||t.formControl.value===i||t.formControl.patchValue(i,{emitEvent:!1}),e instanceof o.FormArray?e.push(t.formControl):e instanceof o.FormGroup&&e.addControl(this.fieldKey(t),t.formControl)},e.prototype.getFieldModel=function(e,t){return t.fieldGroup||t.fieldArray?e:f(e,t,!1)},e.prototype.getParentModel=function(e,t){return t.key&&(t.fieldGroup||t.fieldArray)?f(e,t,!0):e},e.prototype.removeFieldControl=function(e,t){e instanceof o.FormArray?e.removeAt(this.fieldKey(t)):e instanceof o.FormGroup&&e.removeControl(this.fieldKey(t))},e.prototype.fieldParentFormControl=function(e,t){var o=l(t);return o.pop(),o.length>0?e.get(o):e},e.prototype.fieldKey=function(e){return l(e).pop()},e}();A.decorators=[{type:t.Injectable}],A.ctorParameters=function(){return[]};var M=function(){function e(e,t){this.formlyConfig=e,this.formlyFormExpression=t,this.formId=0}return e.prototype.buildForm=function(e,t,o,r){void 0===t&&(t=[]);var i=r&&r.fieldTransform||this.formlyConfig.extras.fieldTransform;Array.isArray(i)||(i=[i]),i.forEach(function(i){if(i&&!(t=i(t,o,e,r)))throw new Error("fieldTransform must return an array of fields")}),this._buildForm(e,t,o,r),this.formlyFormExpression.checkFields(e,t,o,r)},e.prototype._buildForm=function(e,t,o,r){void 0===t&&(t=[]),this.formId++,this.registerFormControls(e,t,o,r)},e.prototype.registerFormControls=function(e,t,r,i){var n=this;t.forEach(function(t,s){if(t.id=a("formly_"+n.formId,t,s),!y(t.defaultValue)&&y(u(r,t.key))&&d(r,t.key,t.defaultValue),n.initFieldOptions(t),n.initFieldExpression(t,r,i),n.initFieldValidation(t),n.initFieldAsyncValidation(t),t.key&&t.type){var p=l({key:t.key}),f=e,c=r;p.forEach(function(e,r){var i=e.toString();if(r===p.length-1)n.addFormControl(f,t,c,i);else{var s=f.get(i);s||(s=new o.FormGroup({}),n.addControl(f,i,s)),c[e]||(c[e]="string"==typeof e?{}:[]),f=s,c=c[e]}})}t.fieldGroup&&(t.type||(t.type="formly-group"),t.key?(n.addFormControl(e,t,(h={},h[t.key]=t.fieldArray?[]:{},h),t.key),r[t.key]=r[t.key]||(t.fieldArray?[]:{}),n._buildForm(t.formControl,t.fieldGroup,r[t.key],i)):(t.hideExpression&&t.fieldGroup.forEach(function(e){var o=e.hideExpression||function(){return!1};"string"==typeof o&&(o=b(o,["model","formState"])),e.hideExpression=function(e,r){return t.hide||o(e,r)}}),n._buildForm(e,t.fieldGroup,r,i)));var h})},e.prototype.initFieldExpression=function(e,t,o){if(e.expressionProperties)for(var r in e.expressionProperties)0===r.indexOf("field.")&&console.warn("FormlyForm: field("+e.key+') using "field." path in "expressionProperties" is deprecated, use "'+r.replace("field.","")+'" instead.'),("string"==typeof e.expressionProperties[r]||g(e.expressionProperties[r]))&&(e.expressionProperties[r]={expression:g(e.expressionProperties[r])?e.expressionProperties[r]:b(e.expressionProperties[r],["model","formState"]),expressionValueSetter:O(0===r.indexOf("field.")||0===r.indexOf("model.")?r:"field."+r,["expressionValue","model","field"])});e.hideExpression&&(delete e.hide,"string"==typeof e.hideExpression&&(e.hideExpression=b(e.hideExpression,["model","formState"])))},e.prototype.initFieldOptions=function(e){e.templateOptions=e.templateOptions||{},e.type&&(this.formlyConfig.getMergedField(e),e.key&&(e.templateOptions=Object.assign({label:"",placeholder:"",focus:!1},e.templateOptions)))},e.prototype.initFieldAsyncValidation=function(e){var t=this,r=[];if(e.asyncValidators){for(var i in e.asyncValidators)!function(t){"validation"!==t&&r.push(function(o){var r=e.asyncValidators[t];return C(r)&&(r=r.expression),new Promise(function(i){return r(o,e).then(function(e){i(e?null:(o={},o[t]=!0,o));var o})})})}(i)}e.asyncValidators&&Array.isArray(e.asyncValidators.validation)&&e.asyncValidators.validation.forEach(function(o){return r.push(t.wrapNgValidatorFn(e,o))}),r.length&&(e.asyncValidators&&!Array.isArray(e.asyncValidators.validation)?e.asyncValidators.validation=o.Validators.composeAsync([e.asyncValidators.validation].concat(r)):e.asyncValidators={validation:o.Validators.composeAsync(r)})},e.prototype.initFieldValidation=function(e){var t=this,r=[];if(E.filter(function(t){return e.templateOptions&&e.templateOptions.hasOwnProperty(t)||e.expressionProperties&&e.expressionProperties["templateOptions."+t]}).forEach(function(o){r.push(function(r){return!1===e.templateOptions[o]?null:t.getValidation(o,e.templateOptions[o])(r)})}),e.validators){for(var i in e.validators)!function(t){"validation"!==t&&r.push(function(o){var r=e.validators[t];return C(r)&&(r=r.expression),r(o,e)?null:(i={},i[t]=!0,i);var i})}(i)}e.validators&&Array.isArray(e.validators.validation)&&e.validators.validation.forEach(function(o){return r.push(t.wrapNgValidatorFn(e,o))}),r.length&&(e.validators&&!Array.isArray(e.validators.validation)?e.validators.validation=o.Validators.compose([e.validators.validation].concat(r)):e.validators={validation:o.Validators.compose(r)})},e.prototype.addFormControl=function(e,t,r,i){var n;t.formControl instanceof o.AbstractControl||e.get(i)?h((n=t.formControl||e.get(i)).value)&&h(r[i])||n.value===r[i]||!(n instanceof o.FormControl)||n.patchValue(r[i]):n=t.component&&t.component.createControl?t.component.createControl(r[i],t):t.fieldGroup&&t.key&&t.key===i&&!t.fieldArray?new o.FormGroup(r[i],t.validators?t.validators.validation:undefined,t.asyncValidators?t.asyncValidators.validation:undefined):t.fieldArray&&t.key&&t.key===i?new o.FormArray([],t.validators?t.validators.validation:undefined,t.asyncValidators?t.asyncValidators.validation:undefined):new o.FormControl(r[i],t.validators?t.validators.validation:undefined,t.asyncValidators?t.asyncValidators.validation:undefined),t.templateOptions.disabled&&n.disable(),delete t.templateOptions.disabled&&Object.defineProperty(t.templateOptions,"disabled",{get:function(){return!this.formControl.enabled}.bind(t),set:function(e){this.expressionProperties&&this.expressionProperties.hasOwnProperty("templateOptions.disabled")&&(this.expressionProperties["templateOptions.disabled"].expressionValue=e),e?this.formControl.disable():this.formControl.enable()}.bind(t),enumerable:!0,configurable:!0}),this.addControl(e,i,n,t)},e.prototype.addControl=function(e,t,r,i){i&&(i.formControl=r),e instanceof o.FormArray?e.at(t)!==r&&e.setControl(t,r):e.get(t)!==r&&e.setControl(t,r)},e.prototype.getValidation=function(e,t){switch(e){case"required":return o.Validators.required;case"pattern":return o.Validators.pattern(t);case"minLength":return o.Validators.minLength(t);case"maxLength":return o.Validators.maxLength(t);case"min":return o.Validators.min(t);case"max":return o.Validators.max(t)}},e.prototype.wrapNgValidatorFn=function(e,t){return t="string"==typeof t?this.formlyConfig.getValidator(t).validation:t,function(o){return t(o,e)}},e}();M.decorators=[{type:t.Injectable}],M.ctorParameters=function(){return[{type:w},{type:A}]};var P=function(){function e(e,r,i,n,s,a){this.formlyBuilder=e,this.formlyExpression=r,this.formlyConfig=i,this.parentForm=n,this.parentFormGroup=s,this.parentFormlyForm=a,this.model={},this.form=new o.FormGroup({}),this.fields=[],this.modelChange=new t.EventEmitter,this.isRoot=!0,this.modelChangeSubs=[]}return e.prototype.ngDoCheck=function(){this.checkExpressionChange()},e.prototype.ngOnChanges=function(e){this.fields&&0!==this.fields.length&&this.isRoot&&(e.fields||e.form?(this.model=this.model||{},this.form=this.form||new o.FormGroup({}),this.setOptions(),this.clearModelSubscriptions(),this.formlyBuilder.buildForm(this.form,this.fields,this.model,this.options),this.trackModelChanges(this.fields),this.updateInitialValue()):e.model&&this.patchModel(this.model))},e.prototype.ngOnDestroy=function(){this.clearModelSubscriptions()},e.prototype.fieldModel=function(e,t){return void 0===t&&(t=this.model),e.key&&(e.fieldGroup||e.fieldArray)?f(t,e,!0):t},e.prototype.changeModel=function(e){d(this.model,e.key,e.value),this.modelChange.emit(this.model),this.checkExpressionChange()},e.prototype.setOptions=function(){var e=this;this.options=this.options||{},this.options.formState=this.options.formState||{},this.options.showError||(this.options.showError=this.formlyConfig.extras.showError),this.options.fieldChanges||(this.options.fieldChanges=new r.Subject),this.options.resetModel||(this.options.resetModel=this.resetModel.bind(this)),this.options.parentForm||(this.options.parentForm=this.parentFormGroup||this.parentForm),this.options.updateInitialValue||(this.options.updateInitialValue=this.updateInitialValue.bind(this)),this.options.resetTrackModelChanges||(this.options.resetTrackModelChanges=function(){e.clearModelSubscriptions(),e.trackModelChanges(e.fields)})},e.prototype.checkExpressionChange=function(){this.isRoot&&this.formlyExpression.checkFields(this.form,this.fields,this.model,this.options)},e.prototype.trackModelChanges=function(e,t){var o=this;void 0===t&&(t=[]),e.forEach(function(e){if(e.key&&e.type&&!e.fieldGroup&&!e.fieldArray){var r=e.formControl.valueChanges,s=e.modelOptions&&e.modelOptions.debounce&&e.modelOptions.debounce["default"];s>0&&(r=i.debounceTime.call(r,s)),e.parsers&&e.parsers.length>0&&e.parsers.forEach(function(e){r=n.map.call(r,e)}),o.modelChangeSubs.push(r.subscribe(function(r){return o.changeModel({key:t.concat([e.key]).join("."),value:r})}))}e.fieldGroup&&e.fieldGroup.length>0&&o.trackModelChanges(e.fieldGroup,e.key?t.concat([e.key]):t)})},e.prototype.clearModelSubscriptions=function(){this.modelChangeSubs.forEach(function(e){return e.unsubscribe()}),this.modelChangeSubs=[]},e.prototype.patchModel=function(e){this.clearModelSubscriptions(),this.resetFieldArray(this.fields,e,this.model),this.initializeFormValue(this.form),this.form.patchValue(e,{onlySelf:!0}),this.trackModelChanges(this.fields)},e.prototype.resetModel=function(e){e=h(e)?this.initialModel:e,this.resetFieldArray(this.fields,e,this.model),!this.parentFormlyForm&&this.options.parentForm&&this.options.parentForm.control===this.form?this.options.parentForm.resetForm(e):this.form.reset(e)},e.prototype.resetFieldArray=function(e,t,o){var r=this;e.forEach(function(e){if(e.fieldGroup&&e.fieldGroup.length>0||e.fieldArray){var i=r.fieldModel(e,t),n=r.fieldModel(e,o);if(e.fieldArray){e.fieldGroup=e.fieldGroup||[],e.fieldGroup.length=0,n!==i&&n&&(n.length=0);for(var s=e.formControl;0!==s.length;)s.removeAt(0);i.forEach(function(t,o){n[o]=t,e.fieldGroup.push(Object.assign({},F(e.fieldArray),{key:""+o})),r.formlyBuilder.buildForm(s,[e.fieldGroup[o]],i,r.options)})}else r.resetFieldArray(e.fieldGroup,i,n)}else e.key&&e.type&&e.formControl.reset(f(t,e,!1))})},e.prototype.initializeFormValue=function(e){var t=this;e instanceof o.FormControl?e.setValue(null):e instanceof o.FormGroup?Object.keys(e.controls).forEach(function(o){return t.initializeFormValue(e.controls[o])}):e instanceof o.FormArray&&e.controls.forEach(function(e){return t.initializeFormValue(e)})},e.prototype.updateInitialValue=function(){this.initialModel=c({},this.model)},e}();P.decorators=[{type:t.Component,args:[{selector:"formly-form",template:'\n    <formly-field *ngFor="let field of fields"\n      [model]="fieldModel(field)" [form]="form"\n      [field]="field"\n      [ngClass]="field.className"\n      [options]="options">\n    </formly-field>\n    <ng-content></ng-content>\n  '}]}],P.ctorParameters=function(){return[{type:M},{type:A},{type:w},{type:o.NgForm,decorators:[{type:t.Optional}]},{type:o.FormGroupDirective,decorators:[{type:t.Optional}]},{type:P,decorators:[{type:t.Optional},{type:t.SkipSelf}]}]},P.propDecorators={model:[{type:t.Input}],form:[{type:t.Input}],fields:[{type:t.Input}],options:[{type:t.Input}],modelChange:[{type:t.Output}],isRoot:[{type:t.Input}]};var G=function(){function e(e,o){this.formlyConfig=e,this.componentFactoryResolver=o,this.options={},this.modelChange=new t.EventEmitter,this.componentRefs=[]}return e.prototype.ngOnInit=function(){this.field.template||this.createFieldComponent()},e.prototype.ngOnChanges=function(e){var t=this;this.componentRefs.forEach(function(e){Object.assign(e.instance,{model:t.model,form:t.form,field:t.field,options:t.options})})},e.prototype.ngOnDestroy=function(){this.componentRefs.forEach(function(e){return e.destroy()}),this.componentRefs=[]},e.prototype.createFieldComponent=function(){var e=this,t=this.formlyConfig.getType(this.field.type),o=this.getFieldWrappers(t),r=this.fieldComponent;return o.forEach(function(t){var o=e.createComponent(r,e.formlyConfig.getWrapper(t).component);r=o.instance.fieldComponent}),this.createComponent(r,t.component)},e.prototype.getFieldWrappers=function(e){var t=this,o={preWrapper:[],postWrapper:[]};this.field.templateOptions&&this.mergeTemplateManipulators(o,this.field.templateOptions.templateManipulators),this.mergeTemplateManipulators(o,this.formlyConfig.templateManipulators);var r=o.preWrapper.map(function(e){return e(t.field)}).filter(function(e){return e}),i=o.postWrapper.map(function(e){return e(t.field)}).filter(function(e){return e});return this.field.wrappers||(this.field.wrappers=[]),e.wrappers||(e.wrappers=[]),r.concat(this.field.wrappers,i)},e.prototype.mergeTemplateManipulators=function(e,t){return(t=t||{}).preWrapper&&(e.preWrapper=e.preWrapper.concat(t.preWrapper)),t.postWrapper&&(e.postWrapper=e.postWrapper.concat(t.postWrapper)),e},e.prototype.createComponent=function(e,t){var o=this.componentFactoryResolver.resolveComponentFactory(t),r=e.createComponent(o);return Object.assign(r.instance,{model:this.model,form:this.form,field:this.field,options:this.options}),this.componentRefs.push(r),r},e}();G.decorators=[{type:t.Component,args:[{selector:"formly-field",template:'\n    <ng-template #fieldComponent></ng-template>\n    <div *ngIf="field.template && !field.fieldGroup" [innerHtml]="field.template"></div>\n  ',host:{"[style.display]":'field.hide ? "none":""'}}]}],G.ctorParameters=function(){return[{type:w},{type:t.ComponentFactoryResolver}]},G.propDecorators={model:[{type:t.Input}],form:[{type:t.Input}],field:[{type:t.Input}],options:[{type:t.Input}],modelChange:[{type:t.Output}],fieldComponent:[{type:t.ViewChild,args:["fieldComponent",{read:t.ViewContainerRef}]}]};var j=function(){function e(e,t){this.renderer=e,this.elementRef=t,this.attributes=["id","name","placeholder","tabindex","step","readonly"],this.statements=["change","keydown","keyup","keypress","click","focus","blur"]}return e.prototype.onFocus=function(){this.field.focus=!0},e.prototype.onBlur=function(){this.field.focus=!1},e.prototype.ngOnChanges=function(e){var t=this;if(e.field){var o=e.field;if(this.attributes.filter(function(e){return t.canApplyRender(o,e)}).forEach(function(e){return t.renderer.setAttribute(t.elementRef.nativeElement,e,t.getPropValue(t.field,e))}),this.field.templateOptions&&this.field.templateOptions.attributes){var r=this.field.templateOptions.attributes;Object.keys(r).forEach(function(e){return t.renderer.setAttribute(t.elementRef.nativeElement,e,r[e])})}this.statements.filter(function(e){return t.canApplyRender(o,e)}).forEach(function(e){return t.renderer.listen(t.elementRef.nativeElement,e,t.getStatementValue(e))}),(o.previousValue||{}).focus!==(o.currentValue||{}).focus&&this.elementRef.nativeElement.focus&&this.elementRef.nativeElement[this.field.focus?"focus":"blur"]()}},e.prototype.getPropValue=function(e,t){return(e=e||{}).templateOptions&&e.templateOptions[t]?e.templateOptions[t]:e[t]||""},e.prototype.getStatementValue=function(e){var t=this,o=this.field.templateOptions[e];return 2===o.length&&console.warn("FormlyForm: field("+this.field.key+') Passing formControl as a second argument for "'+e+'" is deprecated and it will be removed in the 3.0 version, use "field.formControl" instead'),function(e){return 2!==o.length?o(t.field,e):o(t.field,t.formControl)}},e.prototype.canApplyRender=function(e,t){var o=this.getPropValue(this.field,t);return this.getPropValue(e.previousValue,t)!==o&&(-1===this.statements.indexOf(t)||"function"==typeof o)},e}();j.decorators=[{type:t.Directive,args:[{selector:"[formlyAttributes]"}]}],j.ctorParameters=function(){return[{type:t.Renderer2},{type:t.ElementRef}]},j.propDecorators={field:[{type:t.Input,args:["formlyAttributes"]}],formControl:[{type:t.Input}],onFocus:[{type:t.HostListener,args:["focus"]}],onBlur:[{type:t.HostListener,args:["blur"]}]};var T=function(){function e(){}return Object.defineProperty(e.prototype,"key",{get:function(){return this.field.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formControl",{get:function(){return this.field.formControl||this.form.get(this.key)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"to",{get:function(){return this.field.templateOptions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showError",{get:function(){return this.options.showError(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.field.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formState",{get:function(){return this.options.formState||{}},enumerable:!0,configurable:!0}),e}();T.propDecorators={form:[{type:t.Input}],field:[{type:t.Input}],model:[{type:t.Input}],options:[{type:t.Input}]};var I=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return k(t,e),t.prototype.ngOnInit=function(){this.lifeCycleHooks(this.lifecycle.onInit)},t.prototype.ngOnChanges=function(e){this.lifeCycleHooks(this.lifecycle.onChanges)},t.prototype.ngDoCheck=function(){this.lifeCycleHooks(this.lifecycle.doCheck)},t.prototype.ngAfterContentInit=function(){this.lifeCycleHooks(this.lifecycle.afterContentInit)},t.prototype.ngAfterContentChecked=function(){this.lifeCycleHooks(this.lifecycle.afterContentChecked)},t.prototype.ngAfterViewInit=function(){this.lifeCycleHooks(this.lifecycle.afterViewInit)},t.prototype.ngAfterViewChecked=function(){this.lifeCycleHooks(this.lifecycle.afterViewChecked)},t.prototype.ngOnDestroy=function(){this.lifeCycleHooks(this.lifecycle.onDestroy)},Object.defineProperty(t.prototype,"lifecycle",{get:function(){return this.field.lifecycle||{}},enumerable:!0,configurable:!0}),t.prototype.lifeCycleHooks=function(e){e&&e.bind(this)(this.form,this.field,this.model,this.options)},t}(T),R=function(e){function t(t){var o=e.call(this)||this;return o.builder=t,o}return k(t,e),t.createControl=function(e,t){var r=new o.FormArray([],t.validators?t.validators.validation:undefined,t.asyncValidators?t.asyncValidators.validation:undefined);return t.fieldGroup=[],(e||[]).forEach(function(e,o){return t.fieldGroup.push(Object.assign({},F(t.fieldArray),{key:""+o}))}),r},t.prototype.add=function(e,t){e=h(e)?this.field.fieldGroup.length:e,this.model.splice(e,0,t?F(t):undefined),this.field.fieldGroup.splice(e,0,Object.assign({},F(this.field.fieldArray))),this.field.fieldGroup.forEach(function(e,t){e.key=""+t}),this.builder.buildForm(this.formControl,[this.field.fieldGroup[e]],this.model,this.options),this.options.resetTrackModelChanges()},t.prototype.remove=function(e){this.formControl.removeAt(e),this.field.fieldGroup.splice(e,1),this.field.fieldGroup.forEach(function(e,t){return e.key=""+t}),this.model.splice(e,1),this.options.resetTrackModelChanges()},t}(I),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return k(t,e),t}(T),_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return k(t,e),t}(I);_.decorators=[{type:t.Component,args:[{selector:"formly-group",template:'\n    <formly-form\n      [fields]="field.fieldGroup"\n      [isRoot]="false"\n      [model]="model"\n      [form]="field.formControl || form"\n      [options]="options"\n      [ngClass]="field.fieldGroupClassName">\n      <ng-content></ng-content>\n    </formly-form>\n  '}]}],_.ctorParameters=function(){return[]};var W=function(){function e(e){this.formlyConfig=e}return Object.defineProperty(e.prototype,"errorMessage",{get:function(){for(var e in this.fieldForm.errors)if(this.fieldForm.errors.hasOwnProperty(e)){var t=this.formlyConfig.getValidatorMessage(e);return this.field.validation&&this.field.validation.messages&&this.field.validation.messages[e]&&(t=this.field.validation.messages[e]),this.field.validators&&this.field.validators[e]&&this.field.validators[e].message&&(t=this.field.validators[e].message),this.field.asyncValidators&&this.field.asyncValidators[e]&&this.field.asyncValidators[e].message&&(t=this.field.asyncValidators[e].message),"function"==typeof t?t(this.fieldForm.errors[e],this.field):t}},enumerable:!0,configurable:!0}),e}();W.decorators=[{type:t.Component,args:[{selector:"formly-validation-message",template:"{{ errorMessage }}"}]}],W.ctorParameters=function(){return[{type:w}]},W.propDecorators={fieldForm:[{type:t.Input}],field:[{type:t.Input}]};var N=function(){function e(){}return e.forRoot=function(o){return void 0===o&&(o={}),{ngModule:e,providers:[M,A,w,{provide:x,useValue:{types:[{name:"formly-group",component:_}]},multi:!0},{provide:x,useValue:o,multi:!0},{provide:t.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:o,multi:!0}]}},e.forChild=function(o){return void 0===o&&(o={}),{ngModule:e,providers:[{provide:x,useValue:o,multi:!0},{provide:t.ANALYZE_FOR_ENTRY_COMPONENTS,useValue:o,multi:!0}]}},e}();N.decorators=[{type:t.NgModule,args:[{declarations:[P,G,j,_,W],entryComponents:[_],exports:[P,G,j,_,W],imports:[s.CommonModule,o.ReactiveFormsModule]}]}],N.ctorParameters=function(){return[]},e.FormlyForm=P,e.FormlyField=G,e.FormlyAttributes=j,e.FormlyConfig=w,e.FormlyFormBuilder=M,e.Field=T,e.FieldType=I,e.FieldArrayType=R,e.FieldWrapper=S,e.FormlyModule=N,e.ɵc=_,e.ɵa=x,e.ɵb=A,e.ɵd=W,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=core.umd.min.js.map
